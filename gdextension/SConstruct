#!/usr/bin/env python
"""
SConstruct for MaXtreme GDExtension
Builds the C++ game engine as a Godot GDExtension
"""
import os
import sys

# --- Auto-detect godot-cpp ---
env = SConscript("godot-cpp/SConstruct")

# --- Extension source files ---
# For now, just the GDExtension entry point and wrapper classes
# Later phases will add the full maxr engine sources
env.Append(CPPPATH=["src/"])

sources = Glob("src/*.cpp")

# --- Build the shared library ---
if env["platform"] == "macos":
    library = env.SharedLibrary(
        "../bin/libmaxtreme.{}.{}.framework/libmaxtreme.{}.{}".format(
            env["platform"], env["target"], env["platform"], env["target"]
        ),
        source=sources,
    )
else:
    library = env.SharedLibrary(
        "../bin/libmaxtreme{}{}".format(env["suffix"], env["SHLIBSUFFIX"]),
        source=sources,
    )

Default(library)
